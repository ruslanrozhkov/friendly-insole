<div class="modal fade" id="shippingLabelModal" tabindex="-1" role="dialog" aria-labelledby="shippingLabelModalLabel">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <%= form_tag '/generate_shipping_label' do %>
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title" id="shippingLabelModalLabel">Generate Shipping Label</h4>
          </div>

          <div class="modal-body">
            <!-- # Careful, we can do this because we don't allow splitting shipments,
            if we bring that feature back in from spree, we will have to find another way to generate this form -->
            <% shipments.each do |shipment| %>
                <div class="row">
                  <div class="col-sm-2">
                    <%= image_tag 'parcel.png', class: 'img-responsive' %>
                  </div>
                  <div class="col-sm-2">
                    <%= label_tag 'shipment[service_type]', :method %>
                    <h5><%= shipment.shipping_method.name %></h5>
                    <%= hidden_field_tag 'shipment[service_type]', shipment.shipping_method.code %>

                    <h5>Item count: <strong><%= shipment.item_count %></strong></h5>
                  </div>
                  <div class="col-sm-2">
                    <div class="form-group">
                      <%= label_tag 'shipment[weight]', :weight %>
                      <%= text_field_tag 'shipment[weight]', shipment.dimension_totals.weight, class: 'form-control' %>
                      <p class="help-block small">in ounces</p>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="form-group">
                      <%= label_tag 'shipment[width]', :width %>
                      <%= text_field_tag 'shipment[width]', shipment.dimension_totals.width, class: 'form-control' %>
                      <p class="help-block small">in inches</p>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="form-group">
                      <%= label_tag 'shipment[length]', :length %>
                      <%= text_field_tag 'shipment[length]', shipment.dimension_totals.length, class: 'form-control' %>
                      <p class="help-block small">in inches</p>
                    </div>
                  </div>
                  <div class="col-sm-2">
                    <div class="form-group">
                      <%= label_tag 'shipment[height]', :height %>
                      <%= text_field_tag 'shipment[height]', shipment.dimension_totals.height, class: 'form-control' %>
                      <p class="help-block small">in inches</p>
                    </div>
                  </div>
                </div>

                <div class="alert alert-warning">
                  The address forms below are editable in the event where a shipping label cannot be auto-generated by the pre-populated address information. If the delivery address must be changed, please try changing it <%= link_to 'here', spree.admin_order_customer_url(shipment.order) %> first.
                </div>

                <div class="row">
                  <div class="col-sm-6">
                    <div class="form-group">
                      <%= label_tag 'shipment[from_name]', 'From Name' %>
                      <%= text_field_tag 'shipment[from_name]', shipment.stock_location.admin_name, class: 'form-control' %>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[from_address_1]', 'From Address 1' %>
                      <%= text_field_tag 'shipment[from_address_1]', shipment.stock_location.address1, class: 'form-control' %>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[from_address_2]', 'From Address 2' %>
                      <%= text_field_tag 'shipment[from_address_2]', shipment.stock_location.address2, class: 'form-control' %>
                      <p class="small help-block">Use for Suite or Apartment number</p>
                    </div>
                    <div class="row">
                      <div class="col-sm-5">
                        <div class="form-group">
                          <%= label_tag 'shipment[from_city]', 'From City' %>
                          <%= text_field_tag 'shipment[from_city]', shipment.stock_location.city, class: 'form-control' %>
                        </div>
                      </div>
                      <div class="col-sm-3">
                        <div class="form-group">
                          <%= label_tag 'shipment[from_state]', 'From State' %>
                          <%= text_field_tag 'shipment[from_state]', shipment.stock_location.state.abbr, class: 'form-control' %>
                        </div>
                      </div>
                      <div class="col-sm-4">
                        <div class="form-group">
                          <%= label_tag 'shipment[from_zip_5]', 'From Zip' %>
                          <%= text_field_tag 'shipment[from_zip_5]', shipment.stock_location.zipcode, class: 'form-control' %>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-sm-6">
                    <div class="form-group">
                      <%= label_tag 'shipment[to_name]', 'To Name' %>
                      <%= text_field_tag 'shipment[to_name]', "#{shipment.address.firstname} #{shipment.address.lastname}", class: 'form-control' %>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[to_firm]', 'To Firm' if Spree::Config[:company] %>
                      <%= text_field_tag 'shipment[to_firm]', shipment.address.company, class: 'form-control' if Spree::Config[:company] %>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[to_address_1]', 'To Address 1' %>
                      <%= text_field_tag 'shipment[to_address_1]', shipment.address.address1, class: 'form-control' %>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[to_address_2]', 'To Address 2' %>
                      <%= text_field_tag 'shipment[to_address_2]', shipment.address.address2, class: 'form-control' %>
                      <p class="small help-block">Use for Suite or Apartment number</p>
                    </div>
                    <div class="row">
                      <div class="col-sm-5">
                        <div class="form-group">
                          <%= label_tag 'shipment[to_city]', 'To City' %>
                          <%= text_field_tag 'shipment[to_city]', shipment.address.city, class: 'form-control' %>
                        </div>
                      </div>
                      <div class="col-sm-3">
                        <div class="form-group">
                          <%= label_tag 'shipment[to_state]', 'To State' %>
                          <%= text_field_tag 'shipment[to_state]', shipment.address.state.abbr, class: 'form-control' %>
                        </div>
                      </div>
                      <div class="col-sm-4">
                        <div class="form-group">
                          <%= label_tag 'shipment[to_zip_5]', 'To Zip' %>
                          <%= text_field_tag 'shipment[to_zip_5]', shipment.address.zipcode, class: 'form-control' %>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <%= label_tag 'shipment[to_email]', 'To Email' %>
                      <%= text_field_tag 'shipment[to_email]', shipment.order.user.email, class: 'form-control' %>
                    </div>
                  </div>
                </div>
                <%= hidden_field_tag :order_number, shipment.order.number %>
            <% end %>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Done</button>
            <%= submit_tag 'Generate', class: 'btn btn-primary', id: 'submit-generate-label' %>
          </div>
      <% end %>
    </div>
  </div>
</div>